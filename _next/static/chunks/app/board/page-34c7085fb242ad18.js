(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{958:(e,s,t)=>{Promise.resolve().then(t.bind(t,5849))},5849:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k,getScore:()=>y});var r=t(1047),i=t(6847),n=t(8001),a=t.n(n),l=t(402),c=t(2784),o=t(1500),h=t(1748);let d=(0,h.A)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),u=(0,h.A)("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),m=(0,h.A)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);var p=t(9572),x=t(9039);function f(e){let{className:s,...t}=e;return(0,r.jsx)("div",{className:(0,x.cn)("animate-pulse rounded-md bg-muted",s),...t})}var b=t(7405),j=t(8462),v=t(7609);async function y(e){let s=[1e3,1500,500,200],t=s[Math.floor(Math.random()*s.length)];return console.log("Fetching score for ".concat(e.name,"... (").concat(t,"ms)")),new Promise(s=>{setTimeout(()=>{s({participant:e,score:Math.floor(100*Math.random())})},t)})}function g(e){let{participant:s}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.nA,{children:(0,r.jsx)(f,{className:"h-5 w-5 mx-auto"})}),(0,r.jsx)(o.nA,{children:(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsxs)("span",{className:"text-gray-500",children:["Loading ",null==s?void 0:s.name," score"]})})}),(0,r.jsx)(o.nA,{className:"text-right",children:(0,r.jsx)(f,{className:"h-5 w-10"})}),(0,r.jsx)(o.nA,{className:"text-right",children:(0,r.jsx)(f,{className:"h-8 w-16 mx-auto"})})]})}function w(e,s){return e.find(e=>e.participant.id===s.id)||null}function N(e){var s,t;let{scores:i,setScores:n,participant:l,model:h}=e,m=l.baseURL,p=l.params,{filters:x,setFilters:f,filteredEndpoints:v}=(0,j.kf)(null==h?void 0:h.endpoints,{}),{isError:y,results:N,errors:k,isLoading:M}=(0,b.Iq)(v,m,p),R=Object.values(N).map(e=>e.score).reduce((e,s)=>e+s,0),O=Object.values(N).map(e=>e.maxScore).reduce((e,s)=>e+s,0);if(M)return(0,r.jsx)(o.Hj,{children:(0,r.jsx)(g,{participant:l})},l.id);let E=w(i,l);M||y||(null==E?void 0:E.score)===R||(console.log("Score for ".concat(l.name,": ").concat(R," / ").concat(O," updated")),n(e=>{let s=[...e],t=s.findIndex(e=>e.participant.id===l.id);return -1!==t?s[t]={...s[t],score:R}:console.error("unknown participant score"),s=s.toSorted((e,s)=>s.score-e.score).map((e,s)=>({...e,rank:s+1}))}));let A=null!==(s=null==(E=w(i,l))?void 0:E.rank)&&void 0!==s?s:-1,C=A&&A<=3?"bg-yellow-50":"";return(0,r.jsxs)(o.Hj,{className:M?"":C,children:[(0,r.jsx)(o.nA,{className:"font-medium",children:(0,r.jsx)("div",{className:"flex items-center justify-center",children:1===(t=A||-1)?(0,r.jsx)(d,{className:"h-5 w-5 text-yellow-500"}):2===t?(0,r.jsx)(u,{className:"h-5 w-5 text-gray-400"}):3===t?(0,r.jsx)(u,{className:"h-5 w-5 text-amber-700"}):(0,r.jsx)("span",{className:"text-gray-500",children:t})})}),(0,r.jsx)(o.nA,{children:l.name}),(0,r.jsxs)(o.nA,{className:"text-right font-semibold",children:[R," (",Math.floor(R/O*100),"%)"]}),(0,r.jsx)(o.nA,{className:"text-right",children:(0,r.jsx)(a(),{href:"/validator?participant=".concat(l.id),children:(0,r.jsx)(c.$,{variant:"outline",size:"sm",children:"View"})})})]},A)}function k(){let e=p.o.participants,[s,t]=(0,i.useState)("desc"),[n,h]=(0,i.useState)(e.map(e=>({participant:e,score:-1}))),{modAPI:u,isLoading:x,isError:f,error:b,yamlUrl:y,setYamlUrl:g}=(0,j.vi)();if(x)return(0,r.jsxs)("div",{className:"flex w-screen h-screen items-center justify-center",children:["Loading MOD API from ",y,"..."]});if(f)return(0,r.jsxs)("div",{className:"flex w-screen h-screen items-center justify-center",children:["Error loading MOD API from ",y,": ",null==b?void 0:b.message]});let w=n.toSorted((e,t)=>"desc"===s?t.score-e.score:e.score-t.score);return(0,r.jsx)("div",{className:"flex flex-col items-center min-h-screen p-4 bg-gray-50",children:(0,r.jsx)("div",{className:"w-full max-w-3xl",children:(0,r.jsxs)(l.Zp,{className:"shadow-lg",children:[(0,r.jsxs)(l.aR,{className:"text-center",children:[(0,r.jsx)(l.ZB,{children:(0,r.jsx)(v.s,{link:"/",children:(0,r.jsxs)("div",{className:"text-2xl font-bold flex items-center justify-center gap-2 flex-end",children:[(0,r.jsx)(d,{className:"h-6 w-6 text-yellow-500"}),"Leaderboard"]})})}),(0,r.jsx)(l.BT,{children:"MOD API specification 2025 call scores"})]}),(0,r.jsxs)(l.Wu,{children:[(0,r.jsx)("div",{className:"flex justify-end mb-2",children:(0,r.jsxs)(c.$,{variant:"outline",size:"sm",onClick:()=>{t(e=>"desc"===e?"asc":"desc")},className:"flex items-center gap-1",children:["Sort ","desc"===s?"Ascending":"Descending",(0,r.jsx)(m,{className:"h-4 w-4"})]})}),(0,r.jsxs)(o.XI,{children:[(0,r.jsx)(o.A0,{children:(0,r.jsxs)(o.Hj,{children:[(0,r.jsx)(o.nd,{className:"w-16",children:"Rank"}),(0,r.jsx)(o.nd,{children:"Participant"}),(0,r.jsx)(o.nd,{className:"text-right",children:"Score"}),(0,r.jsx)(o.nd,{className:"w-28 text-right",children:"Details"})]})}),(0,r.jsx)(o.BF,{children:w.map(e=>(0,r.jsx)(N,{scores:n,setScores:h,participant:e.participant,model:u}))})]})]}),(0,r.jsx)(l.wL,{className:"flex justify-center",children:(0,r.jsx)(a(),{href:"/validator",passHref:!0,children:(0,r.jsx)(c.$,{variant:"default",children:"Add New Score"})})})]})})})}},5302:(e,s,t)=>{"use strict";t.d(s,{E:()=>f});var r=t(6847),i=t(7071),n=t(2857),a=t(2504),l=t(770);function c(e,s){return e.filter(e=>!s.includes(e))}var o=class extends a.Q{#e;#s;#t;#r;#i;#n;#a;#l;#c=[];constructor(e,s,t){super(),this.#e=e,this.#r=t,this.#t=[],this.#i=[],this.#s=[],this.setQueries(s)}onSubscribe(){1===this.listeners.size&&this.#i.forEach(e=>{e.subscribe(s=>{this.#o(e,s)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#i.forEach(e=>{e.destroy()})}setQueries(e,s,t){this.#t=e,this.#r=s,i.j.batch(()=>{let e=this.#i,s=this.#h(this.#t);this.#c=s,s.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions,t));let r=s.map(e=>e.observer),i=r.map(e=>e.getCurrentResult()),n=r.some((s,t)=>s!==e[t]);(e.length!==r.length||n)&&(this.#i=r,this.#s=i,this.hasListeners()&&(c(e,r).forEach(e=>{e.destroy()}),c(r,e).forEach(e=>{e.subscribe(s=>{this.#o(e,s)})}),this.#d()))})}getCurrentResult(){return this.#s}getQueries(){return this.#i.map(e=>e.getCurrentQuery())}getObservers(){return this.#i}getOptimisticResult(e,s){let t=this.#h(e),r=t.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions));return[r,e=>this.#u(e??r,s),()=>this.#m(r,t)]}#m(e,s){return s.map((t,r)=>{let i=e[r];return t.defaultedQueryOptions.notifyOnChangeProps?i:t.observer.trackResult(i,e=>{s.forEach(s=>{s.observer.trackProp(e)})})})}#u(e,s){return s?(this.#n&&this.#s===this.#l&&s===this.#a||(this.#a=s,this.#l=this.#s,this.#n=(0,l.BH)(this.#n,s(e))),this.#n):e}#h(e){let s=new Map(this.#i.map(e=>[e.options.queryHash,e])),t=[];return e.forEach(e=>{let r=this.#e.defaultQueryOptions(e),i=s.get(r.queryHash);i?t.push({defaultedQueryOptions:r,observer:i}):t.push({defaultedQueryOptions:r,observer:new n.$(this.#e,r)})}),t}#o(e,s){let t=this.#i.indexOf(e);-1!==t&&(this.#s=function(e,s,t){let r=e.slice(0);return r[s]=t,r}(this.#s,t,s),this.#d())}#d(){if(this.hasListeners()){let e=this.#n,s=this.#m(this.#s,this.#c);e!==this.#u(s,this.#r?.combine)&&i.j.batch(()=>{this.listeners.forEach(e=>{e(this.#s)})})}}},h=t(9260),d=t(4720),u=t(4538),m=t(8438),p=t(7763),x=t(964);function f(e,s){let{queries:t,...a}=e,l=(0,h.jE)(s),c=(0,d.w)(),f=(0,u.h)(),b=r.useMemo(()=>t.map(e=>{let s=l.defaultQueryOptions(e);return s._optimisticResults=c?"isRestoring":"optimistic",s}),[t,l,c]);b.forEach(e=>{(0,p.jv)(e),(0,m.LJ)(e,f)}),(0,m.wZ)(f);let[j]=r.useState(()=>new o(l,b,a)),[v,y,g]=j.getOptimisticResult(b,a.combine),w=!c&&!1!==a.subscribed;r.useSyncExternalStore(r.useCallback(e=>w?j.subscribe(i.j.batchCalls(e)):x.l,[j,w]),()=>j.getCurrentResult(),()=>j.getCurrentResult()),r.useEffect(()=>{j.setQueries(b,a,{listeners:!1})},[b,a,j]);let N=v.some((e,s)=>(0,p.EU)(b[s],e))?v.flatMap((e,s)=>{let t=b[s];if(t){let s=new n.$(l,t);if((0,p.EU)(t,e))return(0,p.iL)(t,s,f);(0,p.nE)(e,c)&&(0,p.iL)(t,s,f)}return[]}):[];if(N.length>0)throw Promise.all(N);let k=v.find((e,s)=>{let t=b[s];return t&&(0,m.$1)({result:e,errorResetBoundary:f,throwOnError:t.throwOnError,query:l.getQueryCache().get(t.queryHash),suspense:t.suspense})});if(null==k?void 0:k.error)throw k.error;return y(g())}}},e=>{var s=s=>e(e.s=s);e.O(0,[973,665,1,462,738,721,59,358],()=>s(958)),_N_E=e.O()}]);